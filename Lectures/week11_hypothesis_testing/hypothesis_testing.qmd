---
title: "Inferenatial Statistics: Hypothesis Testing"
author: "Hakan Mehmetcik"
format: pdf
editor: visual
execute: 
  echo: true
  warning: true
  output: asis
df-print: kable
---

## Hypotheses Testing 

Hypothesis testing is a fundamental concept in statistics that helps in making decisions based on data from a sample. That is, it is used to assess the evidence in the data and provides a methodology for making decisions using sample data.

### **Key Components of Hypothesis Testing**

1.  **Null Hypothesis (H0)**:

    -   The null hypothesis represents a statement of "no effect" or "no difference."

    -   It is the hypothesis that one seeks to challenge with sample data. For instance, if you want to test whether a new teaching method is more effective than the current one, the null hypothesis would be "the new method is no better than the current method."

2.  **Alternative Hypothesis (H1 or Ha)**:

    -   The alternative hypothesis is a statement that contradicts the null hypothesis. It represents the effect or difference you aim to prove.

    -   Continuing with our example, the alternative hypothesis would be "the new teaching method is better than the current method."

![](images/png.png)

1.  **Type I and Type II Errors**:

    -   **Type I Error (Î±)**: This error occurs when the null hypothesis is true, but we incorrectly reject it. It is also known as the "false positive" error.

    -   **Type II Error (Î²)**: This error occurs when the null hypothesis is false, but we fail to reject it, which is a "false negative" error.

![](images/clipboard-2977202868.png)

1.  **Significance Level (Î±)**:

    -   The probability of rejecting the null hypothesis when it is true (Type I error).

    -   Common choices for Î± are 0.05 (5%), 0.01 (1%), and 0.10 (10%). Choosing a lower Î± reduces the chances of a Type I error.

2.  **p-value**:

    -   The p-value is the probability of observing a test statistic at least as extreme as the one observed, under the assumption that the null hypothesis is true.

    -   If the p-value is less than the chosen significance level Î±, we reject the null hypothesis.

::: callout-note
### ðŸ’¡  **Court Case Analogy for Hypothesis Testing**

In a court case, a defendant is considered innocent until proven guilty. This setup is analogous to hypothesis testing in the following ways:

**Null Hypothesis (H0)**

-   **Court Case:** The defendant is innocent.

**Alternative Hypothesis (H1)**

-   **Court Case:** The defendant is guilty.

**Types of Errors**

**Type I Error (Î±)**

-   **Court Case:** The defendant is innocent (truth), but is wrongly convicted (judgment). This is a false positive â€“ concluding something is true when it is actually false.

**Type II Error (Î²)**

-   **Court Case:** The defendant is guilty (truth), but is wrongly acquitted (judgment). This is a false negative â€“ failing to conclude something is true when it actually is.

**Practical Implications**

Using this analogy, we can see the critical balance in choosing the significance level (Î±) and the power of the test (1 - Î², where Î² is the probability of making a Type II error). Lowering Î± reduces the risk of convicting an innocent person (making a Type I error), but may increase the chance of acquitting a guilty person (making a Type II error).
:::

## Step-by-Step Procedure of Hypothesis Testing

### **Step 1: Formulate Hypotheses**

First, you need to define your null hypothesis (H0) and your alternative hypothesis (H1). These hypotheses should be mutually exclusive and collectively exhaustive.

-   **Null Hypothesis (H0):** Typically posits no effect or no difference between groups. For example, "there is no difference in the mean test scores between students taught under different teaching methods."

-   **Alternative Hypothesis (H1 or Ha):** Posits an effect or a difference. For example, "students taught by Method B have higher average test scores than those taught by Method A."

### **Step 2: Choose a Suitable Test**

Select a statistical test based on the type of data and the hypothesis you are testing. The choice of test depends on several factors:

-   **Type of data** (e.g., nominal, ordinal, interval, ratio)

-   **Distribution of data** (e.g., normal distribution or not)

-   **Sample size**

-   **Dependence between samples** (independent vs paired or matched samples)

Common tests include:

-   **t-test** for one sample mean or comparing the means of two groups.

-   **ANOVA** for comparing the means of three or more groups.

-   **Chi-square test** for testing relationships between categorical variables.

-   **Regression analysis** for understanding relationships between variables.

### **Step 3: Compute the Test Statistic**

After choosing the appropriate test:

-   Collect the sample data.

-   Calculate the test statistic using the formula specific to the test chosen. This involves measures like the mean, standard deviation, and others depending on the test.

### **Step 4: Obtain and Interpret the p-value**

-   **p-value:** Calculate or obtain the p-value, which helps you determine the significance of the results.

-   The p-value represents the probability of observing your data, or something more extreme, if the null hypothesis is true.

### **Step 5: Make a Decision Based on the p-value and Alpha (Î±)**

-   Compare the p-value with your pre-determined significance level (Î±, commonly set at 0.05).

-   If the p-value is **less than or equal to Î±**, reject the null hypothesis (evidence suggests an effect).

-   If the p-value is **greater than Î±**, do not reject the null hypothesis (not enough evidence to suggest an effect).

### **Step 6: Report the Results**

-   Clearly state whether you rejected or did not reject the null hypothesis.

-   Discuss the implications of your findings in the context of the study.

### **Example 1: One-Sample t-Test** 

**Scenario and Data**

Suppose agronomists have developed a new variety of corn and claim that its average height at maturity is different from the national average height of 150 cm for standard corn varieties.

**Data**

We'll assume that the heights of 12 samples of this new variety of corn at maturity are as follows (in cm):
155,153,149,156,151,154,152,150,151,153,152,150155,153,149,156,151,154,152,150,151,153,152,150

#### **Step 1: Formulate Hypotheses**

-   **Null Hypothesis (H0):** The mean height of the new corn variety is 150 cm.

-   **Alternative Hypothesis (H1):** The mean height of the new corn variety is not 150 cm.

#### **Step 2: Choose a Suitable Test**

-   **Test Chosen:** One-sample t-test, as we are comparing the sample mean to a known population mean.

-   **Type of Data:** Continuous (heights of corn)

-   **Sample Size:** 12 corn plants

#### **Step 3: Compute the Test Statistic**

-   Use the following R code to calculate the t-test:

```{r}
# Define the sample data
corn_heights <- c(155, 153, 149, 156, 151, 154, 152, 150, 151, 153, 152, 150)

# Perform a one-sample t-test
t_test_result <- t.test(corn_heights, mu = 150)

```

#### **Step 4: Obtain and Interpret the p-value**

```{r}
# Print the test result
print(t_test_result)
```

**Test Output Interpretation**:

-   **t-value**: 3.5322 indicates the calculated t-statistic, which measures the number of standard deviations the sample mean deviates from the hypothesized mean (150 cm). A positive value indicates the sample mean is above the hypothesized mean.

-   **p-value**: 0.004697, which quantifies the probability of observing a test statistic at least as extreme as the one observed, under the assumption that the null hypothesis (H0: the true mean is 150) is true.

**Interpretation**:
Given that the p-value (0.004697) is significantly less than the common alpha level of 0.05, there is strong statistical evidence to reject the null hypothesis. This indicates that the mean height of the new corn variety is statistically different from 150 cm.

#### **Step 5: Make a Decision Based on the p-value and Alpha (Î±)**

-   Since the **p-value (0.004697) \< Î± (0.05)**, reject the null hypothesis.

-   The evidence suggests that the average height of the new corn variety is significantly different from 150 cm.

#### **Step 6: Report the Results**

-   **Practical Implications**: The increased height might suggest better growth characteristics under certain conditions, which could be beneficial for yield.

### **Example 2: One-Sample t-Test Using the `PlantGrowth` Dataset**

The **`PlantGrowth`** dataset in R consists of weights of plants grown under control and two different treatment conditions. For simplicity, letâ€™s focus on testing whether the mean weight of plants under one treatment condition differs from a known or hypothesized population mean.

#### **Step 1: Formulate Hypotheses**

**Scenario**: Assume the historical data suggests that the mean weight of plants under similar growth conditions is 5 grams. We'll test if the treatment 'trt1' (treatment 1) in the dataset differs from this historical mean.

-   **Null Hypothesis (H0):** The mean weight of plants treated with 'trt1' is 5 grams.

-   **Alternative Hypothesis (H1):** The mean weight of plants treated with 'trt1' is not equal to 5 grams.

#### **Step 2: Choose a Suitable Test**

Given the data type (continuous) and the objective (comparing a sample mean to a known value), a one-sample t-test is suitable.

-   **Test Type**: One-sample t-test

-   **Data Type**: Continuous (weight of plants)

-   **Distribution**: Assume normality for the t-test application; this should ideally be checked with a normality test such as Shapiro-Wilk if the sample size is small.

#### **Step 3: Compute the Test Statistic**

First, extract the data for 'trt1' from the dataset, then perform the t-test.

```{r}
# Load the data
data("PlantGrowth")
# Filter for 'trt1'
trt1_data <- PlantGrowth$weight[PlantGrowth$group == 'trt1']

# Perform the one-sample t-test against the hypothesized mean of 5
t_test_result <- t.test(trt1_data, mu = 5)

```

#### **Step 4: Obtain and Interpret the p-value**

The output of the t-test will provide the necessary statistics including the p-value.

```{r}
# Print the results
print(t_test_result)
```

**Test Output Interpretation**:

-   **t-value**: -1.3507, which indicates the direction and magnitude of the difference between the sample mean and the hypothesized mean. A negative value suggests the sample mean is less than the hypothesized mean of 5 grams.

-   **Degrees of Freedom (df)**: 9, calculated as the number of observations minus one (n-1).

-   **p-value**: 0.2098, which quantifies the probability of observing a test statistic at least as extreme as the one observed, under the assumption that the null hypothesis (H0: the true mean is 5) is true.

-   **95% Confidence Interval**: \[4.093239, 5.228761\], indicates the range of values within which we can be 95% confident that the true population mean lies. This interval includes the hypothesized mean (5 grams), suggesting that this mean is a plausible value for the population mean given the sample data.

-   **Sample Estimates (Mean of x)**: 4.661, which is the observed sample mean of the treatment group **`trt1`**.

**Interpretation**:
Given that the p-value (0.2098) is greater than the common alpha level of 0.05, there is insufficient evidence to reject the null hypothesis. The data does not provide strong evidence to suggest that the treatment significantly deviates from the hypothesized mean of 5 grams.

#### **Step 5: Make a Decision Based on the p-value and Alpha (Î±)**

-   **Alpha (Î±)**: Set at 0.05.

-   **Decision**:

    -   Since the **p-value (0.2098) \> Î± (0.05)**, fail to reject the null hypothesis.

    -   This decision indicates that there is not enough statistical evidence to conclude that the mean weight of plants treated with **`trt1`** is different from 5 grams.

#### **Step 6: Report the Results**

-   **Reporting**:

    -   State that the one-sample t-test performed on the plant weights from treatment group **`trt1`** resulted in a t-value of -1.3507 with a p-value of 0.2098, which was not sufficient to reject the null hypothesis at the 5% significance level.

    -   Mention that the 95% confidence interval for the mean weight of the plants ranges from approximately 4.09 to 5.23 grams, which includes the hypothesized mean of 5 grams.

-   **Implications**:

    -   Discuss the implications of these results in terms of treatment effectiveness. The results suggest that the treatment does not significantly alter the plant growth from the expected 5 grams, implying that the treatment may not be effective in significantly enhancing growth beyond the hypothesized mean.

### **Example 2: Two-Sample t-Test Using the `sleep` Dataset**

#### **Step 1: Formulate Hypotheses**

-   **Null Hypothesis (H0)**: There is no difference in the mean extra sleep between the two drug groups.

-   **Alternative Hypothesis (H1)**: There is a difference in the mean extra sleep between the two drug groups.

#### **Step 2: Choose a Suitable Test**

-   A **two-sample t-test** is appropriate as we are comparing the means of two independent groups under the assumption that the populations have unequal variances (hence, Welchâ€™s t-test).

#### **Step 3: Compute the Test Statistic**

```{r}
data("sleep")
t_test_result <- t.test(extra ~ group, data = sleep)
t_test_result
```

#### **Step 4: Obtain and Interpret the p-value**

-   The p-value from the t-test output will indicate whether the differences in means are statistically significant. The p-value is 0.07939. This value tells us the probability of observing as extreme or more extreme differences between the two groups under the null hypothesis that there is no difference between them.

#### **Step 5: Make a Decision Based on the p-value and Alpha (Î±)**

-   If **p-value â‰¤ 0.05**, reject H0; otherwise, fail to reject H0. The p-value of 0.07939 is greater than the typical alpha level of 0.05. This means we do not have enough evidence to reject the null hypothesis at the 5% significance level. In other words, we fail to reject the null hypothesis and conclude that there is no statistically significant difference in the mean extra sleep between the two drug groups, given the data.

#### **Step 6: Report the Results**

-   Present the t-test results, discuss the implications if the null hypothesis is rejected or not, and consider any potential limitations of the study. Although there appears to be a difference in the mean extra sleep favoring group 2, this difference isn't statistically significant at the conventional threshold. Clinically or practically, it suggests that further investigation with perhaps a larger sample size might be needed to conclusively determine if there indeed is a difference caused by the drugs, or if the observed difference was just by chance.

### **Example 3: ANOVA Test by Using ToothGrowth Dataset** 

ANOVA (Analysis of Variance) is a statistical method used to test differences between three or more group means to see if at least one group mean is statistically different from the others. For this example, letâ€™s use the built-in **`ToothGrowth`** dataset in R, which measures the effect of vitamin C on tooth growth in guinea pigs. The dataset includes two key variables: **`len`** (length of tooth growth) and **`supp`** (type of supplement, either VC for Vitamin C or OJ for orange juice), and **`dose`** (dose level of the supplement).

We will perform a one-way ANOVA to compare the tooth growth (**`len`**) across different dose levels of supplements.

#### **Step 1: Formulate Hypotheses**

-   **Null Hypothesis (H0):** There is no difference in the mean tooth growth (**`len`**) across the different doses of vitamin C supplements.

-   **Alternative Hypothesis (H1):** At least one dose level has a different mean tooth growth compared to the others.

#### **Step 2: Choose a Suitable Test**

Given that the data involves comparing the means of tooth growth across more than two groups (different doses), and assuming the data meets necessary assumptions (normality, independence, and homogeneity of variances). Thus, ANOVA (Analysis of Variance) is appropriate as it allows comparing the means across three or more groups to determine if there is any statistically significant difference.

### **Step 3: Compute the Test Statistic**

-   Load and check the dataset, and then compute the ANOVA:

```{r}
# Load the data
data("ToothGrowth")

# If 'dose' is not a factor, convert it to a factor
ToothGrowth$dose <- as.factor(ToothGrowth$dose)

# Check basic data structure
str(ToothGrowth)
summary(ToothGrowth)

# Perform ANOVA
anova_result <- aov(len ~ dose, data = ToothGrowth)
summary(anova_result)
```

### **Step 4: Obtain and Interpret the p-value**

The output from the ANOVA (**`aov`**) function provides key statistics about the effects of **`dose`** on **`len`** (tooth length). Here's how to interpret the critical elements:

-   **F value:** 67.42, a measure of the variance ratio between the mean squares of the treatment and the residuals. This high value suggests a strong model fit.

-   **p-value:** 9.53e-16, extremely small, providing compelling evidence to reject the null hypothesis.**Interpretation**: Given the very low p-value, there is strong statistical evidence to reject the null hypothesis. This result suggests that different dose levels have significantly different effects on tooth growth.

**Interpretation:** The extremely low p-value suggests that the differences in tooth growth across the three dose levels are statistically significant. The mean tooth growth is not the same for all dosage levels, with each increment likely having a different impact on growth outcomes.

### **Step 5: Make a Decision Based on the p-value and Alpha (Î±)**

-   **Alpha (Î±) Level:** Typically set at 0.05.

-   **Decision:** Since the p-value (9.53e-16) is far less than 0.05, we reject the null hypothesis.

-   **Conclusion:** There is statistically significant evidence that different doses of vitamin C have different effects on tooth growth in guinea pigs.

### **Step 6: Report the Results**

-   **Summarize the Analysis:** Clearly state that the ANOVA revealed significant differences in tooth growth across the different doses of Vitamin C administered to guinea pigs.

-   **Detailed Findings:** Highlight that as the dose increases, the mean tooth length significantly changes, suggesting a dose-response relationship.

-   **Post-hoc Analysis:** Given the significant ANOVA result, perform a post-hoc analysis to identify which specific doses differ significantly. This can be done using Tukey's Honestly Significant Difference (HSD) test.

```{r}
# Assuming anova_result is the result from aov call
post_hoc <- TukeyHSD(anova_result)
print(post_hoc)
```

-   **Graphical Representation**: It might also be beneficial to include graphical summaries (e.g., box plots) to visually represent the differences between groups.

```{r}
boxplot(len ~ dose, data = ToothGrowth,
        main = "Tooth Growth by Vitamin C Dose Levels",
        xlab = "Dose of Vitamin C (mg)",
        ylab = "Tooth Length",
        col = c("lightblue", "lightgreen", "pink"))
```

### **Example 4: Chi-Square Test of Independence Using `UCBAdmissions` Dataset**

#### **Step 1: Formulate Hypotheses**

-   **Null Hypothesis (H0)**: Gender and admission status are independent.

-   **Alternative Hypothesis (H1)**: Gender and admission status are not independent.

#### **Step 2: Choose a Suitable Test**

-   The **Chi-square test of independence** is suitable for testing relationships between two categorical variables.

#### **Step 3: Compute the Test Statistic**

```{r}
data("UCBAdmissions")
# Sum across departments to get a two-way table of Gender by Admit status
admission_table <- apply(UCBAdmissions, c(1, 2), sum)
print(admission_table)

chi_sq_result <- chisq.test(admission_table)
print(chi_sq_result)


```

#### **Step 4: Obtain and Interpret the p-value**

-   Interpret the chi-square testâ€™s p-value to determine if the observed distribution of counts is significantly different from the expected distribution if H0 were true.

-   The p-value is reported as being less than 2.2e-16, which is effectively 0 for practical purposes. This extremely small p-value suggests that the probability of observing such an extreme chi-squared value under the null hypothesis is virtually zero.

#### **Step 5: Make a Decision Based on the p-value and Alpha (Î±)**

-   If **p-value â‰¤ 0.05**, reject H0; otherwise, fail to reject H0.

-   The results imply that gender has a substantial impact on admission decisions at UC Berkeley, according to the data analyzed. This finding could suggest bias or an underlying factor that correlates with both gender and admission likelihood, which might warrant further investigation to understand the causes and address potential equity issues.

#### **Step 6: Report the Results**

-   Explain what the findings mean in the context of gender bias in admissions, detailing the statistical significance and potential social implications. From a practical viewpoint, this test's result implies that gender does not influence admission decisions across different departments at the University of California, Berkeley, based on the data in the **`UCBAdmissions`** dataset.

-   This result is crucial for policy makers, educational administrators, and the broader academic community, highlighting the need for continuous monitoring and possibly recalibrating admission processes to ensure fairness and equity.

### **Example 5: Simple Linear Regression Using the `mtcars` Dataset**

#### **Step 1: Formulate Hypotheses**

-   **Null Hypothesis (H0)**: There is no relationship between the weight of cars (wt) and fuel efficiency (mpg).

-   **Alternative Hypothesis (H1)**: Heavier cars (greater wt) have lower fuel efficiency (mpg).

#### **Step 2: Choose a Suitable Test**

-   **Simple linear regression** is appropriate for modeling the relationship between two continuous variables and assessing the strength and direction of the relationship.

#### **Step 3: Compute the Test Statistic**

```{r}
data("mtcars")
model <- lm(mpg ~ wt, data = mtcars)
summary(model)

```

#### **Step 4: Obtain and Interpret the p-value**

-   The summary of the regression model will provide p-values for the slope coefficients, which indicate whether the relationship between weight and mpg is statistically significant.

-   Extremely small, providing strong evidence against the null hypothesis and indicating a statistically significant negative effect of weight on mpg.

#### **Step 5: Make a Decision Based on the p-value and Alpha (Î±)**

-   If **p-value â‰¤ 0.05** for the weight coefficient, reject H0; otherwise, fail to reject H0. We reject the Null that there is no relationship between the weight of cars (wt) and fuel efficiency (mpg).

#### **Step 6: Report the Results**

-   Discuss the relationship between car weight and fuel efficiency, the strength of the relationship (R-squared), and any implications or recommendations for car design or consumer choice.

-   There is a need for lighter cars for better fuel efficiency.
